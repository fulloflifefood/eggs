<div class="grid_10">

<h1>Transaction History for: <%= @subscription.account.member.last_name %></h1>

<h3>Current <%= @subscription.product.name %> Balance: <%= @subscription.current_balance %></h3>

<table>
  <tr>
    <th>Timestamp</th>
    <th>Date of pickup</th>
    <th>Description</th>
    <th>Order ID</th>
    <th>Amount</th>    
    <th>Balance</th>
  </tr>

<% @subscription_transactions.each do |subscription_transaction| %>
  <tr>
    <td><%= subscription_transaction.created_at %></td>
    <td><%= subscription_transaction.date %></td>
    <td><%= subscription_transaction.description %></td>
    <td><%= subscription_transaction.order_id %></td>
    <td style="<%= 'color:green;font-weight:bold' if !subscription_transaction.debit? %>"><%= subscription_transaction.debit? ? "-" : "+"%><%= subscription_transaction.amount.to_i %></td>
    <td><%= subscription_transaction.balance.to_i %></td>
  </tr>
<% end %>
</table>

<br />
<% if current_user.has_role?(:admin, @farm) %>
    <%= link_to "Back to subscriptions", subscriptions_path(:farm_id => @farm.id, :product_id => @subscription.product.id) %>
<% end %>
<br/>
<% if current_user.has_role?(:member) %>
    <%= link_to "Back to Dashboard", user_path(:id => current_user.id, :farm_id => @farm.id) %>
<% end %>
</div>